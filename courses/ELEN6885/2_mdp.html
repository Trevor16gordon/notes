
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Markov Decision Processes &#8212; Columbia MS EE Notes</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.e2363ea40746bee74734a24ffefccd78.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Model Based RL" href="3_model_based_rl.html" />
    <link rel="prev" title="Bandit Problems" href="1_2_bandit_problems.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Columbia MS EE Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Intro
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Course Notes
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ELEN4720_overview.html">
   Machine Learning for signals, information, data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ELEN4720/1_intro.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ELEN4720/2_regression.html">
     Ridge / Polynomial Regression From Scratch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ELEN4720/3_classification.html">
     Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ELEN4720/4_class_naive_bayes.html">
     Naive Bayes Classifier
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ELEN4720/4_naive_bayes.html">
     Naive Bayes Classifier From Scratch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ELEN4720/5_logistic_regression.html">
     Logistic Regression Classifier From Scratch
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ELEN4720/6_gaussian_processes.html">
     Gaussian Processes ML Model From Scratch
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ECBM4040_overview.html">
   Neural Networks and Deep Learning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ECBM4040/1_intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ECBM4040/2_normalization.html">
     Batch Normalization for NN
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ECBM4040/3_optimizers.html">
     Optimizers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ECBM4040/4_cnn.html">
     Convolutional Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ECBM4040/6_residual_neural_networks.html">
     Residual Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ECBM4040/7_recurren_neural_netowkrs.html">
     Recurrent Neural Networks
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../ELEN6885_overview.html">
   Reinforcement Learning
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="1_1_overview.html">
     Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="1_2_bandit_problems.html">
     Bandit Problems
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Markov Decision Processes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3_model_based_rl.html">
     Model Based RL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_model_free_rl.html">
     Model Free RL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="99_assignment1.html">
     ELEN 6885 Assignment 1 - Trevor Gordon
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rl_balancing_exploration_notebook.html">
     Simple Reinforcement Algorithms From Scratch
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../EECS4750_overview.html">
   Heterogeneous Computing for Signal and Data Processing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../EECS4750/1_intro.html">
     Intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../EECS4750/2_overview.html">
     Overview
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../EECS4750/3_block_grid_size.html">
     Block And Grid Size
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Other Notes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../chapters/Notes/feedforward_neural_network.html">
   Neural Networks
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Key Terminology
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../chapters/key_terminology/notes.html">
   Key Terminology
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/courses/ELEN6885/2_mdp.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://trevor16gordon.github.io/notes/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://trevor16gordon.github.io/notes//issues/new?title=Issue%20on%20page%20%2Fcourses/ELEN6885/2_mdp.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Markov Decision Processes
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#markov">
   Markov
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#markov-reward-processes">
     Markov Reward Processes
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Markov Decision Processes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#policy">
   Policy
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#greedy-policy">
     Greedy Policy
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#epsilon-greedy-policy">
     Epsilon Greedy Policy
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#softmax-policy">
     Softmax Policy
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="markov-decision-processes">
<h1>Markov Decision Processes<a class="headerlink" href="#markov-decision-processes" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="markov">
<h1>Markov<a class="headerlink" href="#markov" title="Permalink to this headline">¶</a></h1>
<p>A markov process is a stochastic process that is memoryless. That means that the future only depends on the current state, not on the history.</p>
<div class="section" id="markov-reward-processes">
<h2>Markov Reward Processes<a class="headerlink" href="#markov-reward-processes" title="Permalink to this headline">¶</a></h2>
<p>A markov reward process has
<strong>States</strong>: Finite set of states
<strong>Rewards</strong>: Rs is the expecation of awards for a given state
<strong>State Transition Prob Matrix</strong>: Probability of moving to the other states given a current state
<strong>Discount Factor</strong>: How much to weigh current rewards vs future ones. In range [0,1].</p>
</div>
<div class="section" id="id1">
<h2>Markov Decision Processes<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>A markov decision process is an extension of the MRP where the agent now has a set of actions.
<strong>Actions</strong>: Finite set of actions
<strong>States</strong>: Finite set of states
<strong>Rewards</strong>: Rs is the expecation of awards for a given state
<strong>State Transition Prob Matrix</strong>: Probability of moving to the other states given a current state and current action
<strong>Discount Factor</strong>: How much to weigh current rewards vs future ones. In range [0,1].</p>
</div>
</div>
<div class="section" id="policy">
<h1>Policy<a class="headerlink" href="#policy" title="Permalink to this headline">¶</a></h1>
<p>A policy’s value function assigns a value to each state or to each state, action pair. There is one optimal value function but many possible optimal policies</p>
<div class="amsmath math notranslate nohighlight" id="equation-91f9cab7-ed9d-4b7a-bb20-bd17c82bdb06">
<span class="eqno">(14)<a class="headerlink" href="#equation-91f9cab7-ed9d-4b7a-bb20-bd17c82bdb06" title="Permalink to this equation">¶</a></span>\[\begin{align}
\pi \left( a|s\right) =P\left[ A_{t}=a|S_{t}=s\right] 
\end{align}\]</div>
<div class="section" id="greedy-policy">
<h2>Greedy Policy<a class="headerlink" href="#greedy-policy" title="Permalink to this headline">¶</a></h2>
<p>For the greedy policy, always choose the action with the highest expected reward. The drawback to this policy is that an agents estimate of the value of actions is likely not the true value. In this case, it is usefull to explore other states. The following policies provide a way for exploring</p>
</div>
<div class="section" id="epsilon-greedy-policy">
<h2>Epsilon Greedy Policy<a class="headerlink" href="#epsilon-greedy-policy" title="Permalink to this headline">¶</a></h2>
<p>This policy aims to help balance exploration vs exploitation. With probability (1-e) choose the greedy policy. With probability e/n choose any action.</p>
</div>
<div class="section" id="softmax-policy">
<h2>Softmax Policy<a class="headerlink" href="#softmax-policy" title="Permalink to this headline">¶</a></h2>
<p>The softmax policy allows you to tweak the temperature over time to explore less and exploit more as time goes to infinity.</p>
<div class="amsmath math notranslate nohighlight" id="equation-8fae7281-06e9-458e-9b4a-c18178164edb">
<span class="eqno">(15)<a class="headerlink" href="#equation-8fae7281-06e9-458e-9b4a-c18178164edb" title="Permalink to this equation">¶</a></span>\[\begin{align}
\sigma \left( Q(a)\right) =\dfrac{e^{\dfrac{Q(a)}{\tau}}}{\sum ^{k}_{j=1}e^{\dfrac{Q(a)}{\tau};}}
\end{align}\]</div>
<p>In the limit as the temperature τ → 0, softmax action selection becomes the same as greedy action selection.
Proof:</p>
<div class="amsmath math notranslate nohighlight" id="equation-614d6086-7eff-415a-9a67-1be3a6de93de">
<span class="eqno">(16)<a class="headerlink" href="#equation-614d6086-7eff-415a-9a67-1be3a6de93de" title="Permalink to this equation">¶</a></span>\[\begin{align}
\begin{aligned}\lim _{\tau \rightarrow \infty }P\left( a\right) =\dfrac{\exp \left( Q_{t}\left( a\right) /\tau \right) }{\Sigma _{i=1}^{n}\exp \left( Q_{t}\left( i\right) /\tau \right) }\\
\lim _{\tau \rightarrow \infty }P\left( a\right) =\dfrac{\exp \left( Q_{t}\left( a\right) /\infty \right) }{\sum ^{n}_{i=1}\exp \left( Q_{t}\left( i\right) /\infty \right) }\\
\lim _{t\rightarrow \infty }P\left( a\right) =\dfrac{1}{n}\end{aligned}
\end{align}\]</div>
<p>In the limit as τ → ∞, softmax action selection yields equiprobable selection among all actions.
Proof:</p>
<div class="amsmath math notranslate nohighlight" id="equation-73890754-72fe-49a8-9d8f-28145e2fb61e">
<span class="eqno">(17)<a class="headerlink" href="#equation-73890754-72fe-49a8-9d8f-28145e2fb61e" title="Permalink to this equation">¶</a></span>\[\begin{align}
\begin{aligned}p\left( a=1\right) =\dfrac{e^{Q_{t}\left( 1\right) /\tau }}{e^{Q_{t}\left( 1\right) /\tau }+e^{Q_{t}\left( 2\right) /\tau }}\\
\dfrac{1}{Q_{t}\left( 2\right) /\tau }\\
P\left( a=1\right) =1+\dfrac{e}{e^{Qt}}\dfrac{}{\left( 1\right) /\tau }\\
P\left( a=1\right) =\dfrac{1}{1+e^{\dfrac{1}{T}\left( Q+121-Q+\left( 1\right) \right) }}\end{aligned}
\end{align}\]</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./courses/ELEN6885"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="1_2_bandit_problems.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Bandit Problems</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="3_model_based_rl.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Model Based RL</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Trevor Gordon<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>